FROM kernsuite/base:3
RUN docker-apt-install python3-pip # python3-casacore
RUN pip3 install --upgrade pip setuptools
ADD . /code
WORKDIR /code
# Test base install without optional installs works
# Most of the tests will be skipped
RUN pip3 install .[testing]
RUN py.test -s -vvv /code/africanus
# Testing install
RUN docker-apt-install python3-casacore
RUN pip3 install .[astropy,dask,python-casacore,scipy,testing]
RUN py.test -s -vvv /code/africanus
